\chapter{\texorpdfstring{$\ell$}{ℓ}-adic representations attached to elliptic
curves}\label{ch:iv}
\chaptermark{Elliptic curves}

Let $K$ be a number field and let $E$ be an elliptic curve over $K$.
\dpage
If $\ell$ is a prime number, let
\[
	\rho_\ell \colon \Gal(\algcl K/K) \longrightarrow \Aut(V_\ell(E))
\]
be the corresponding $\ell$-adic representation of $K$, cf.\ chap.~\ref{ch:i},
\ref{sec:I_12}.  The main result of this Chapter is the determination of the
Lie algebra of the $\ell$-adic Lie group $G_\ell = \Img(\rho_\ell)$. This is
based on a finiteness theorem of \v Safarevi\v c (\ref{sec:IV_14}) combined
with the properties of locally algebraic abelian representations
(chap.~\ref{ch:iii}) and Tate's local theory of elliptic curves with
non-integral modular invariant (Appendix, \ref{sec:IV_A1}). The variation of
$G_\ell$ with $\ell$ is studied in \S\ref{sec:IV_3}.

The Appendix gives analogous results in the local case (i.e.\ when $K$ is a
local field).

\section{Preliminaries}\dpage
\subsection[Elliptic curves]{Elliptic curves \textmd{(cf.\
\citeauthor{5}~\cite{5}, \citeauthor{9}~\cite{9}, \citeauthor{10}~\cite{10})}}
By an elliptic curve, we mean an abelian variety of dimension
1, i.e.\ a complete, non singular, connected curve of genus 1 with a
given rational point $P_0$, taken as an origin for the composition law
(and often written $o$).

Let $E$ be such a curve. It is well known that $E$ may be embedded, as a
non-singular cubic, in the projective plane $\PP^2_K$, in such a way that $P_0$
becomes a \textquote{flex} (one takes the projective embedding defined by the
complete linear series containing the divisor $3\cdot P_0$). In this embedding,
three points $P_1$, $P_2$, $P_3$ have sum $0$ if and only if the divisor $P_1 +
P_2 + P_3$ is the intersection of $E$ with a line. By choosing a suitable
coordinate system, the equation of $E$ can be written in Weierstrass form
\[
	y^2 = 4x^3 - g_2x - g_3
\]
where $x$, $y$ are non-homogeneous coordinates and the origin $P_0$ is
the point at infinity on the $y$-axis. The discriminant
\[
	\Delta = g_2^3 - 27g_3^2
\]
is non-zero.

The coefficients $g_2$, $g_3$ are determined up to the transformations $g_2
\mapsto u^4 g_2$, $g_3 \mapsto u^6 g_3$, $u \in K^\times$. The modular
invariant $j$ of $E$ is
\[
	j = 2^6 \, 3^3 \, \frac{g_2^3}{g_2^3 - 27g_3^2}
	= 2^6 \, 3^3 \, \frac{g_2^3}{\Delta}.
\]
\dpage
Two elliptic curves have the same $j$ invariant if and only if they become
isomorphic over the algebraic closure of $K$.

(All this remains valid over an arbitrary field, except that, when the
characteristic is 2 or 3, the equation of $E$ has to be written in the more
general form
\[
	y^2 + a_1xy + a_3y + x^3 + a_2x^2 + a_4x + a_6 = 0.
\]
Here again, 0 is the point at infinity on the $y$-axis and the 
corresponding tangent is the line at infinity. There are corresponding
definitions for $\Delta$ and $j$, for which we refer to \citeauthor{9}~\cite{9}
or \citeauthor{20}~\cite{20}; note, however, that there is a misprint in Ogg's
formula for $\Delta$: the coefficient of $\beta_4^3$ should be $-8$ instead of
$-1$.)

\subsection{Good reduction}
Let $v \in M_K^0$ be a finite place of the number field $K$. We denote by
$\mathcal{O}_v$ (resp.\ $\mathfrak{m}_v$, $k_v$) the corresponding local ring
in $K$ (resp.\ its maximal ideal, its residue field).

Let $E$ be an elliptic curve over $K$. One says that $E$ has \strong{good
reduction at $v$} if one can find a coordinate system in $\PP^2_K$ such that
the corresponding equation $f$ for $E$ has coefficient in $\mathcal{O}_v$ and
its reduction $\tilde f \mod{\mathfrak{m}_v}$ defines a non-singular cubic
$\widetilde{E}_v$ (hence an elliptic curve) over the residue field $k_v$ (in
other words, the discriminant $\Delta(f)$ of $f$ must be an invertible element
of $\mathcal{O}_v$).
The curve $\widetilde{E}_v$ is called the \strong{reduction} of $E$ at $v$;
\dpage
it does not depend on the choice of $f$, provided, of course, that $\Delta(f) \in
\mathcal{O}_v^\times$.

One can prove that the above definition is equivalent to the following one:
there is an abelian scheme $E_v$ over $\Spec(\mathcal{O}_v)$, in the sense of
\citeauthor{19}~\cite{19}, chap.\ VI, whose generic fiber is $E$; this scheme
is then unique, and its special fiber is $\widetilde{E}_v$. Note that
$\widetilde{E}_v$ is defined over the finite field $k_v$; we denote its
\strong{Frobenius endomorphism} by $F_v$.

On either definition, one sees that $E$ has \strong{good reduction for
almost all places of $K$}.

If $E$ has good reduction at a given place $v$, its $j$ invariant is
\strong{integral at $v$} (i.e.\ belongs to $\mathcal{O}_v$) and its reduction
$\tilde\jmath \mod{\mathfrak{m}_v}$ is the $j$ invariant of the reduced curve
$\widetilde{E}_v$.

The converse is almost true, but not quite: if $j$ belongs to $\mathcal{O}_v$,
there is a finite extension $L$ of $K$ such that $E \otimes_K L$ has good
reduction at all the places of $L$ dividing $v$ (this is the ``potential good
reduction'' of \citeauthor{32}~\cite{32}, \S 2). For the proof of this, see
\citeauthor{29}~\cite{29}, \S 4, n\textsuperscript{o}~3.

\begin{obs}
The definitions and results of this section have nothing to do with number
fields. They apply to every field with a discrete valuation.
\end{obs}

\subsection{Properties of \texorpdfstring{$V_\ell$}{Vℓ} related to good
reduction}\label{sec:IV_13}
Let $\ell$ be a prime number. We define, as in chap.~\ref{ch:i},
\ref{sec:I_12}, the Galois modules $T_\ell$ and $V_\ell$ by:
\[
	V_\ell = T_\ell \otimes \Q_\ell, \qquad T_\ell = \invlim_n E_{\ell^n}
\]
where $E_{\ell^n}$ is the kernel of $\ell^n \colon E(\algcl K) \to E(\algcl K)$.
\dpage

We denote by $\rho_\ell$ the corresponding homomorphism of $\Gal(\algcl K/K)$
into $\Aut(T_\ell)$. Recall that $E_{\ell^n}$, $T_\ell$ and $V_\ell$ are of
rank 2 over $\Z/\ell^n\Z$, $\Z_\ell$ and $\Q_\ell$, respectively.

Let now $v$ be a place of $K$, with $p_v \ne \ell$ and let $v$ be some
extension of $v$ to $\algcl K$; let $D$ (resp.\ $I$) be the corresponding
decomposition group (resp.\ inertia group), cf.\ chap.~\ref{ch:i},
\ref{sec:I_21}. If $E$ has good reduction at $v$, one easily sees that
reduction at $v$ defines an \emph{isomorphism} of $E_{\ell^n}$ onto the
corresponding module for the reduced curve $\widetilde{E}_v$. In particular,
$E_{\ell^n}$, $T_\ell$, $V_\ell$ are \emph{unramified at $v$}
(chap.~\ref{ch:i}, \ref{sec:I_21}) and the Frobenius automorphism $F_{v,
\rho_\ell}$ of $T_\ell$ corresponds to the Frobenius endomorphism $F_v$ of
$\widetilde{E}_v$. Hence: 
\[
	\det(F_{v, \rho_\ell}) = \det(F_v) = \numnorm v
\]
and
\[
	\det(1 - F_{v, \rho_\ell}) = \det(1 - F_v) = 1 - \tr(F_v) + \numnorm v
\]
is equal to the number of $k_v$-points of $\widetilde{E}_v$.

Conversely:
\begin{thm}[Criterion of Néron-Ogg-\v Safarevi\v c]
If $V$ is unramified at $v$ for some $\ell \ne p_v$, then $E$ has good
reduction at $v$.
\end{thm}
For the proof, see \citeauthor{32}~\cite{32}, \S 1.

\begin{cor}
Let $E$ and $E'$ be two elliptic curves which are isogenous (over $K$). If one
of them has good reduction at a place $v$, the same is true for the other one.
\end{cor}
(Recall that $E$ and $E'$ are said to be \strong{isogenous} if there
\dpage
exists a non-trivial morphism $E \to E'$.)

This follows from the theorem, since the $\ell$-adic representations associated
with $E$ and $E'$ are isomorphic.

\begin{obs}
For a direct proof of this corollary, see \citeauthor{11}~\cite{11}.
\end{obs}

\subsubsection*{Exercise}
Let $S$ be the finite set of places where $E$ does not have good reduction. If
$v \in M_K^0 \setminus S$, we denote by $t_v$ the number of $k_v$-points of the
reduced curve $\widetilde{E}_v$.
\begin{enumerate}[(a)]
	\item Let $\ell$ be a prime number and let $m$ be a positive integer.
		Show that the following properties are equivalent:
	\begin{enumerate}[(i)]
		\item\label{exr:cebotarev_i}
			$t_v \equiv 0 \mod{\ell^m}$ for all $v \in M_K^0 \setminus S$, $p_v \ne \ell$.
		\item\label{exr:cebotarev_ii}
			The set of $v \in M_K^0 \setminus S$ such that $t_v
			\equiv 0 \mod{\ell^m}$ has density one (cf.\ 
			chap.~\ref{ch:i}, 2.2).
		\item\label{exr:cebotarev_iii}
			For all $s \in \Img(\rho)$, one has $\det(1-s) \equiv 0 \mod{\ell^m}$.
	\end{enumerate}
	(The equivalence of \ref{exr:cebotarev_ii} and \ref{exr:cebotarev_iii}
	follows from \v Cebotarev's density theorem. The implications
	\ref{exr:cebotarev_i} $\implies$ \ref{exr:cebotarev_ii} and
	\ref{exr:cebotarev_iii} $\implies$ \ref{exr:cebotarev_i} are easy.)

	\item We take now $m = 1$. Show that the properties
		\ref{exr:cebotarev_i}, \ref{exr:cebotarev_ii} and
		\ref{exr:cebotarev_iii} are equivalent to:
	\begin{enumerate}[resume*]
		\item\label{exr:cebotarev_iv}
			There exists an elliptic curve $E'$ over $K$ such that:
		\begin{itemize}
			\item[$(\alpha)$]
				Either $E'$ is isomorphic to $E$, or there
				exist an isogeny $E' \to E$ of degree $\ell$.
			\item[$(\beta)$]
				The group $E'(K)$ contains an element of order
				$\ell$.
		\end{itemize}
	\end{enumerate}
	(The implication \ref{exr:cebotarev_iv} $\implies$
	\ref{exr:cebotarev_iii} is easy. For the proof of the converse, use
	Exer.~\ref{ex:I11_ex2} of chap.~\ref{ch:i}, \ref{sec:I_11}.)
	[For $m > 2$, see \citeauthor{64}~\cite{64}.]
\end{enumerate}

\subsection{\v Safarevi\v c's theorem}%
\label{sec:IV_14}
\dpage
It is the following (cf.\ \cite{23}):
\begin{thm}
Let $S$ be a finite set of places of $K$. The set of isomorphism classes of
elliptic curves over $K$, with good reduction at all places not in $S$, is
finite.
\end{thm}
Since isogenous curves have the same bad reduction set (cf.\ \ref{sec:IV_13}),
this implies:
\begin{cor}
Let $E$ be an elliptic curve over $K$. Then, up to isomorphism, there are only
a finite number of elliptic curves which are $K$-isogenous to $E$.
\end{cor}

To prove the theorem, we use the following criterion for good reduction:
\begin{lem}
Let $S$ be a finite set of places of $K$ containing the divisors of 2 and 3,
and such that the ring $\mathcal{O}_S$ of $S$-integers is principal. Then, an
elliptic curve $E$ defined over $K$ has good reduction outside $S$ if and only
if its equation can be put in the Weierstrass form $y^2 = 4x^3 - g_2 x - g_3$
with $g_i \in \mathcal{O}_S$ and $\Delta = g_2^3 - 27 g_2^3 \in
\mathcal{O}_S^\times$ (the group of units of $\mathcal{O}_S$).
\end{lem}

\begin{proof}
The sufficiency is trivial. To prove necessity, we write the
curve $E$ in the form
\begin{equation}
	y^2 = 4x^3 - g_2^\prime x - g_3^\prime
	\tag{$*$}
	\label{eq:safarevich_lemma}
\end{equation}
with $g_i^\prime \in K$. Let $v$ be a place of $K$ not in $S$. Then, since
there is good reduction at $v$, and since the divisors of 2 and 3 do not belong
\dpage
to $S$, the curve $E$ can be written in the form
\[
	y^2 = 4x^3 - g_{2, v}^\prime x - g_{3, v}^\prime
\]
with $g_{i, v}$ in the local ring at $v$ and the discriminant $\Delta_v$ a unit
in this ring. Using the properties of the Weierstrass form, there is an element
$u_v \in K$ such that $g_{2, v} = u_v^4 g^\prime_2$, $g_{3, v} = u_v^6
g^\prime_3$, $\Delta_v = u_v^{12} \Delta'$;\label{errata:uv12} moreover, as we
can take $g_{i,v} = g_i^\prime$ for almost all $v$, we see that we can assume
that $u_v = 1$ for almost all $v \notin S$. Since the ring $\mathcal{O}_S$ is
principal, there is an element $u \in K^\times$ with $v(u) = v(u_v)$ for all $v
\notin S$. Then, if we replace $x$ by $u^{-2} x$ and $y$ by $u^{-3} y$ in
\eqref{eq:safarevich_lemma}, the curve $E$ takes the form
\[
	y^2 = 4x^3 - g_2^\prime x - g_3^\prime
\]
with $g_2 = u^4 g^\prime_2$, $g_3 = u^6 g^\prime_3$ and $\Delta = u^{12}
\Delta'$. Since, by construction, $g_i \in \mathcal{O}_S$ and $\Delta \in
\mathcal{O}_S^\times$ the lemma is established.
\end{proof}

\begin{proof}[ of the theorem]
After possibly adding a finite number of places of $K$ to $S$, we may assume
that $S$ contains all the divisors of 2 and 3, and that the ring
$\mathcal{O}_S$ is principal. If $E$ is an elliptic curve defined over $K$
having good reduction outside $S$, the above lemma tells us that we can write
$E$ in the form
\begin{equation}
	y^2 = 4x^3 - g_2^\prime x - g_3^\prime
	\tag{$*$}
	\label{eq:wei_form_star2}
\end{equation}
with $g_i \in \mathcal{O}_S$ and $\Delta = g_2^3 - 27 g_2^3 \in \mathcal{O}_S$.
But, since we are free to multiply $\Delta$ by any $u \in
{(\mathcal{O}_S^\times)}^{12}$, and since
$\mathcal{O}_S^\times/{(\mathcal{O}_S^\times)}^{12}$ is a finite group, we see
that there is a finite set $X \subset \mathcal{O}_S^\times$ such that any
elliptic
\dpage
curve of the above type can be written in the form \eqref{eq:wei_form_star2}
with $g_i \in \mathcal{O}_S$ and $\Delta \in X$. But, for a given $\Delta$, the
equation
\[
	U^3 - 27V^2 = \Delta
\]
represents an affine elliptic curve. Using a theorem of Siegel (generalized by
Mahler and Lang, cf.\ \citeauthor{14}~\cite{14}, chap.~VII), one sees that this
equation has only a \emph{finite} number of solutions in $\mathcal{O}_S$. This
finishes the proof of the theorem.
\end{proof}

\begin{obs}
There are many ways in which one can deduce \v Safarevi\v c's theorem from
Siegel's. The one we followed has been shown to us by Tate.
\end{obs}

\section{The Galois module attached to $E$}
In this section, $E$ denotes an elliptic curve over $K$. We are
interested in the structure of the Galois modules $E_{\ell^n}$, $T_\ell$, $V_\ell$
defined in \ref{sec:IV_13}.

\subsection{The irreducibility theorem}
Recall first that the ring $\End_K(E)$ of $K$-endomorphisms of $E$
is either $\Z$ or of rank 2 over $\Z$. In the first case, we say that $E$
has ``no complex multiplication over $K$.'' If the same is true for any
finite extension of $K$, we say that $E$ has ``no complex 
multiplication.''

\begin{thm}
Assume that $E$ has no complex multiplication over $K$.
\dpage
Then:
\begin{enumerate}[(a)]
\item\label{thm:IV_21_a} $V_\ell$ is irreducible for all primes $\ell$;
\item $E_\ell$ is irreducible for almost all primes $\ell$.
\end{enumerate}
\end{thm}

We need the following elementary result:
\begin{lem}
Let $E$ be an elliptic curve defined over $K$ with $\End_K(E) = \Z$. Then, if
$E' \to E$, $E'' \to E$ are $K$-isogenies with non-isomorphic cyclic kernels,
the curves $E'$ and $E''$ are non-isomorphic over $K$.
\end{lem}
\begin{proof}
Let $n'$ and $n''$ be respectively the orders of the kernels of
$E' \to E$ and $E'' \to E$. Suppose that $E'$ and $E''$ are isomorphic
over $K$, and let $E' \to E''$ be an isomorphism. If $E \to E'$ is the
transpose of the isogeny $E' \to E$, it has a cyclic kernel of order
$n'$, and hence the isogeny $E \to E$, obtained by composition of
$E \to E'$, $E' \to E''$, $E'' \to E$, has for kernel an extension of
$\Z/n''\Z$ by $\Z/n'\Z$. But, since $\End_K(E) = \Z$, this isogeny must be
multiplication by an integer $a$, and its kernel must therefore be of
the form $\Z/a\Z \times \Z/a\Z$. Hence $n'$ and $n''$ divide $a$. Since
$a^2 = n'n''$, we obtain $a = n' = n''$, a contradiction.
\end{proof}

\begin{proof}[ of the theorem]
\begin{enumerate}[(a)]
\item It suffices to show that, if $\End_K(E) = \Z$, there is no
	one-dimensional $\Q_\ell$-subspace of $V_\ell$ stable under
	$\Gal(\algcl K/K)$. Suppose there were one; its intersection $X$ with
	$T_\ell$ would be a submodule of $T_\ell$ with $X$ and $T_\ell/X$ free
	$Z_\ell$-modules of rank 1. For $n \ge 0$, consider the image $X(n)$ of
	$X$ in $E_{\ell^n} = T/\ell^n T$. This is a submodule of $E_\ell$ which
	is cyclic of order $\ell^n$ and stable by $\Gal(\algcl K/K)$. Hence it
	corresponds to a finite $K$-algebraic subgroup of
	\dpage
	$E$ and one can define the quotient curve $E(n) = E/X(n)$. The kernel
	of the isogeny $E \to E(n)$ is cyclic of order $\ell^n$. The above
	lemma then shows that the curves $E(n)$, $n \ge 0$, are pairwise
	non-isomorphic, contradicting the corollary to \v Safarevi\v c's
	theorem (\ref{sec:IV_14}).
\item If $E$ is not irreducible, there exists a Galois submodule $X$ of $E$
	which is one-dimensional over $\F_\ell$. In the same way as above, this
	defines an isogeny $E \to E/X_\ell$ whose kernel is cyclic of order
	$\ell$. The above lemma shows that the curves which correspond to
	different values of $\ell$ are\break non-isomorphic, and one again applies
	the corollary to \v Safarevi\v c's\break theorem.
	\qedhere
\end{enumerate}
\end{proof}

\begin{obs}
One can prove part \ref{thm:IV_21_a} of the above theorem by a quite different
method (cf.\ \cite{25}, \S 3.4); instead of the \v Safarevi\v c's theorem, one
uses the properties of the decomposition and inertia subgroups of
$\Img(\rho_\ell)$, cf.\ Appendix.
\end{obs}
